<view class="container"><view class="px-4 pt-10 pb-4 bg-white"><view class="flex items-center justify-between mb-4"><text class="text-xl font-bold">积分商城</text><view class="flex"><view class="mr-5" bindtap="{{a}}"><text class="iconfont icon-refresh text-gray-500"></text></view><view class="mr-5"><text class="iconfont icon-heart text-gray-500"></text></view><view class="relative"><text class="iconfont icon-shopping-bag text-gray-500"></text><text wx:if="{{b}}" class="badge-dot">{{c}}</text></view></view></view><view class="search-container"><view class="search-input-wrapper"><image src="{{d}}" class="search-icon" bindtap="{{e}}"></image><input type="text" class="search-input" placeholder="搜索环保产品..." bindconfirm="{{f}}" value="{{g}}" bindinput="{{h}}"></input><image wx:if="{{i}}" src="{{j}}" class="clear-icon" bindtap="{{k}}"></image></view><view wx:if="{{l}}" class="search-status mt-2"><view class="flex items-center"><text class="text-sm">关键词: "{{m}}"</text><text class="text-xs text-gray-500 ml-2">(找到 {{n}} 条结果)</text><view class="ml-auto"><text class="text-green-500 text-sm" bindtap="{{o}}">退出搜索</text></view></view></view></view></view><scroll-view scroll-y class="mall-content" refresher-enabled refresher-triggered="{{X}}" bindrefresherrefresh="{{Y}}" bindscrolltolower="{{Z}}"><view class="px-4 py-4 bg-white border-b"><view class="flex items-center justify-between"><view><text class="text-sm text-gray-500">我的环保积分</text><view class="flex items-baseline"><text class="text-2xl font-bold mr-2">{{p}}</text><text class="text-sm text-gray-500">可兑换</text></view></view><view class="bg-green-50 px-4 py-2 rounded-lg"><text class="text-xs text-gray-500 mb-1">本月已获得积分</text><text class="text-green-500 font-semibold">+{{q}}</text></view></view></view><view wx:if="{{r}}" class="update-tip" bindtap="{{s}}"><text class="update-tip-text">商品信息已更新，点击刷新</text></view><view wx:if="{{t}}" class="px-4 py-3 bg-white"><scroll-view scroll-x class="flex whitespace-nowrap pb-2"><text class="{{['category-btn', v && 'active']}}" bindtap="{{w}}">全部</text><text class="{{['category-btn', 'flex-shrink-0', 'space-left', x && 'active']}}" bindtap="{{y}}">热门</text><text class="{{['category-btn', 'flex-shrink-0', 'space-left', z && 'active']}}" bindtap="{{A}}">限时兑换</text><text class="{{['category-btn', 'flex-shrink-0', 'space-left', B && 'active']}}" bindtap="{{C}}">环保用品</text><text class="{{['category-btn', 'flex-shrink-0', 'space-left', D && 'active']}}" bindtap="{{E}}">绿植花卉</text><text class="{{['category-btn', 'flex-shrink-0', 'space-left', F && 'active']}}" bindtap="{{G}}">优惠券</text></scroll-view></view><view class="p-4"><view wx:if="{{H}}"><view wx:if="{{I}}" class="flex flex-col items-center py-10"><text class="iconfont icon-search text-gray-300 text-5xl mb-4"></text><text class="text-gray-500">没有找到相关商品</text></view><view wx:else><view class="grid-2 gap-4"><view wx:for="{{J}}" wx:for-item="reward" wx:key="j" class="product-card"><view class="product-img-container"><image src="{{reward.a}}" alt="{{reward.b}}" class="product-img" binderror="{{reward.c}}"></image><view class="point-tag">{{reward.d}}积分</view></view><view class="p-2"><text class="font-medium text-sm mb-1">{{reward.e}}</text><view class="flex items-center justify-between"><text class="text-xs text-gray-500">库存:{{reward.f}}</text><button wx:if="{{reward.g}}" class="btn-exchange-small" bindtap="{{reward.h}}">兑换</button><button wx:elif="{{reward.i}}" class="btn-exchange-disabled-small">积分不足</button><button wx:else class="btn-exchange-disabled-small">已售罄</button></view></view></view></view></view></view><view wx:else><view wx:if="{{K}}" class="mb-6"><view class="flex justify-between items-center mb-3"><text class="text-lg font-semibold">限时兑换</text><view class="flex items-center"><text class="text-sm text-gray-500" bindtap="{{L}}">查看更多</text><icon-image wx:if="{{M}}" class="text-xs text-gray-500 ml-1" u-i="365a90f7-0" bind:__l="__l" u-p="{{M}}"></icon-image></view></view><view wx:for="{{N}}" wx:for-item="reward" wx:key="n" class="card bg-white p-3 mb-4"><view class="flex items-center"><view class="product-img-container-lg"><image src="{{reward.a}}" alt="{{reward.b}}" class="product-image" binderror="{{reward.c}}"></image><view class="point-tag">{{reward.d}}积分</view></view><view class="ml-4 flex-grow"><text class="font-medium text-sm mb-1">{{reward.e}}</text><text wx:if="{{reward.f}}" class="text-xs text-gray-500 mb-1 line-clamp-2">{{reward.g}}</text><view class="flex items-center mb-1"><text class="stock-tag mr-2">库存{{reward.h}}</text><text wx:if="{{reward.i}}" class="text-xs text-red-500">剩余：{{reward.j}}</text></view><view class="mb-2"><view class="flex justify-between text-xs mb-1"><text>已兑换进度</text><text>70%</text></view><view class="progress-bar"><view class="progress" style="width:70%"></view></view></view><button wx:if="{{reward.k}}" class="btn-exchange" bindtap="{{reward.l}}">立即兑换</button><button wx:elif="{{reward.m}}" class="btn-exchange-disabled">积分不足</button><button wx:else class="btn-exchange-disabled">已售罄</button></view></view></view></view><view wx:if="{{O}}" class="mb-6"><view class="flex justify-between items-center mb-3"><text class="text-lg font-semibold">热门兑换</text><view class="flex items-center"><text class="text-sm text-gray-500" bindtap="{{P}}">查看更多</text><icon-image wx:if="{{Q}}" class="text-xs text-gray-500 ml-1" u-i="365a90f7-1" bind:__l="__l" u-p="{{Q}}"></icon-image></view></view><view class="grid-2 gap-4"><view wx:for="{{R}}" wx:for-item="reward" wx:key="j" class="product-card"><view class="product-img-container"><image src="{{reward.a}}" alt="{{reward.b}}" class="product-img" binderror="{{reward.c}}"></image><view class="point-tag">{{reward.d}}积分</view></view><view class="p-2"><text class="font-medium text-sm mb-1">{{reward.e}}</text><view class="flex items-center justify-between"><text class="text-xs text-gray-500">库存:{{reward.f}}</text><button wx:if="{{reward.g}}" class="btn-exchange-small" bindtap="{{reward.h}}">兑换</button><button wx:elif="{{reward.i}}" class="btn-exchange-disabled-small">积分不足</button><button wx:else class="btn-exchange-disabled-small">已售罄</button></view></view></view></view></view><view wx:if="{{S}}"><view class="flex justify-between items-center mb-3"><text class="text-lg font-semibold">积分兑换专区</text><view class="flex items-center"><text class="text-sm text-gray-500" bindtap="{{T}}">查看更多</text><icon-image wx:if="{{U}}" class="text-xs text-gray-500 ml-1" u-i="365a90f7-2" bind:__l="__l" u-p="{{U}}"></icon-image></view></view><view class="grid-2 gap-4"><view wx:for="{{V}}" wx:for-item="reward" wx:key="j" class="product-card"><view class="product-img-container"><image src="{{reward.a}}" alt="{{reward.b}}" class="product-img" binderror="{{reward.c}}"></image><view class="point-tag">{{reward.d}}积分</view></view><view class="p-2"><text class="font-medium text-sm mb-1">{{reward.e}}</text><view class="flex items-center justify-between"><text class="text-xs text-gray-500">库存:{{reward.f}}</text><button wx:if="{{reward.g}}" class="btn-exchange-small" bindtap="{{reward.h}}">兑换</button><button wx:elif="{{reward.i}}" class="btn-exchange-disabled-small">积分不足</button><button wx:else class="btn-exchange-disabled-small">已售罄</button></view></view></view></view></view></view></view><view wx:if="{{W}}" class="loading-container py-5"><view class="loading-spinner"></view><text class="loading-text">正在加载商品信息...</text></view></scroll-view><uni-popup wx:if="{{at}}" class="r" u-s="{{['d']}}" u-r="redemptionPopup" u-i="365a90f7-3" bind:__l="__l" u-p="{{at}}"><view class="bg-white rounded-lg p-4" style="width:300px"><view class="text-center mb-4"><text class="text-lg font-bold">确认兑换</text></view><view wx:if="{{aa}}" class="mb-4"><view class="flex items-center mb-3"><image src="{{ab}}" class="w-16 h-16 rounded object-cover"></image><view class="ml-3"><text class="font-medium">{{ac}}</text><text class="text-red-500 block">{{ad}}积分</text></view></view><view class="bg-gray-100 p-3 rounded mb-3"><text class="text-sm">您当前积分: {{ae}}</text><text class="text-sm block">兑换后剩余: {{af}}</text></view><view wx:if="{{ag}}"><text class="font-medium mb-2 block">选择收货地址:</text><picker bindchange="{{al}}" value="{{am}}" range="{{an}}"><view class="bg-gray-100 p-2 rounded"><text wx:if="{{ah}}" class="text-sm">{{ai}} {{aj}} - {{ak}}</text><text wx:else class="text-sm">请选择收货地址</text></view></picker></view><view wx:else class="text-center text-red-500 my-3"><text>您还没有添加收货地址</text><text class="text-blue-500 ml-2" bindtap="{{ao}}">去添加</text></view></view><view class="flex justify-between"><button class="btn-cancel" bindtap="{{ap}}">取消</button><button class="btn-confirm" bindtap="{{aq}}" disabled="{{ar}}">确认兑换</button></view></view></uni-popup><uni-popup wx:if="{{ay}}" class="r" u-s="{{['d']}}" u-r="resultPopup" u-i="365a90f7-4" bind:__l="__l" u-p="{{ay}}"><view class="bg-white rounded-lg p-4 text-center" style="width:250px"><text class="text-lg font-bold mb-3 block">{{av}}</text><button class="btn-confirm w-full" bindtap="{{aw}}">确定</button></view></uni-popup></view>