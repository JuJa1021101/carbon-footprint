{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\nimport { checkLoginStatus } from './services/login.js'\n\n\texport default {\n\t\tonLaunch: function() {\n\t\t\tconsole.log('App Launch')\n\t\t\n\t\t// 检查登录状态\n\t\tconst isLoggedIn = checkLoginStatus();\n\t\tif (!isLoggedIn) {\n\t\t\t// 未登录，跳转到登录页\n\t\t\tuni.redirectTo({\n\t\t\t\turl: '/pages/login/login'\n\t\t\t});\n\t\t}\n\t\t},\n\t\tonShow: function() {\n\t\t\tconsole.log('App Show')\n\t\t},\n\t\tonHide: function() {\n\t\t\tconsole.log('App Hide')\n\t\t}\n\t}\n</script>\n\n<style>\n\t/*每个页面公共css */\n\t@import url('./static/style/iconfont.css');\n\t@import url('./static/style/common.css');\n\n\tpage {\n\t\tfont-family: \"PingFang SC\", \"Helvetica Neue\", Arial, sans-serif;\n\t\tbackground-color: #f8f9fa;\n\t}\n</style>\n","import App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\n\n// 在应用启动时初始化所有集合\nasync function initializeCollections() {\n  console.log('应用启动 - 开始初始化所有集合');\n  \n  try {\n    // 首先使用专用函数初始化reward_redemptions集合\n    console.log('尝试初始化reward_redemptions集合...');\n    const redemptionsResult = await uniCloud.callFunction({\n      name: 'emptyFunction'\n    });\n    console.log('reward_redemptions集合初始化结果:', redemptionsResult);\n    \n    // 使用新创建的专用函数再次尝试初始化reward_redemptions集合\n    console.log('使用专用函数再次尝试初始化reward_redemptions集合...');\n    const specialInitResult = await uniCloud.callFunction({\n      name: 'initRedemptionsCollection'\n    });\n    console.log('专用函数初始化结果:', specialInitResult);\n    \n    // 然后初始化所有其他集合\n    console.log('初始化所有其他集合...');\n    const allCollectionsResult = await uniCloud.callFunction({\n      name: 'updateAllCollections'\n    });\n    console.log('所有集合初始化结果:', allCollectionsResult);\n    \n    return true;\n  } catch (error) {\n    console.error('集合初始化失败，但继续启动应用:', error);\n    return false;\n  }\n}\n\n// 初始化后再挂载应用\ninitializeCollections().then(() => {\n  console.log('集合初始化完成，挂载应用');\n  const app = new Vue({\n    ...App\n  });\n  app.$mount();\n}).catch(error => {\n  console.error('集合初始化过程出错，但仍然挂载应用:', error);\n  const app = new Vue({\n    ...App\n  });\n  app.$mount();\n});\n\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nexport function createApp() {\n  const app = createSSRApp(App)\n  \n  // 在Vue3环境下初始化集合\n  setTimeout(async () => {\n    try {\n      // 初始化reward_redemptions集合\n      const redemptionsResult = await uniCloud.callFunction({\n        name: 'emptyFunction'\n      });\n      console.log('Vue3 - reward_redemptions集合初始化结果:', redemptionsResult);\n      \n      // 使用专用函数再次尝试初始化\n      const specialInitResult = await uniCloud.callFunction({\n        name: 'initRedemptionsCollection'\n      });\n      console.log('Vue3 - 专用函数初始化结果:', specialInitResult);\n      \n      // 初始化所有其他集合\n      const allCollectionsResult = await uniCloud.callFunction({\n        name: 'updateAllCollections'\n      });\n      console.log('Vue3 - 所有集合初始化结果:', allCollectionsResult);\n    } catch (error) {\n      console.error('Vue3 - 集合初始化失败，但应用已启动:', error);\n    }\n  }, 1000);\n  \n  return {\n    app\n  }\n}\n// #endif"],"names":["uni","checkLoginStatus","createSSRApp","App","uniCloud"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGC,MAAK,YAAU;AAAA,EACd,UAAU,WAAW;AACpBA,kBAAAA,MAAY,MAAA,OAAA,gBAAA,YAAY;AAGzB,UAAM,aAAaC,eAAAA;AACnB,QAAI,CAAC,YAAY;AAEhBD,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACF;AAAA,EACC;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACtB;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACvB;AACD;ACsCM,SAAS,YAAY;AAC1B,QAAM,MAAME,cAAY,aAACC,SAAG;AAG5B,aAAW,YAAY;AACrB,QAAI;AAEF,YAAM,oBAAoB,MAAMC,cAAQ,GAAC,aAAa;AAAA,QACpD,MAAM;AAAA,MACd,CAAO;AACDJ,oBAAA,MAAA,MAAA,OAAA,iBAAY,qCAAqC,iBAAiB;AAGlE,YAAM,oBAAoB,MAAMI,cAAQ,GAAC,aAAa;AAAA,QACpD,MAAM;AAAA,MACd,CAAO;AACDJ,oBAAY,MAAA,MAAA,OAAA,iBAAA,qBAAqB,iBAAiB;AAGlD,YAAM,uBAAuB,MAAMI,cAAQ,GAAC,aAAa;AAAA,QACvD,MAAM;AAAA,MACd,CAAO;AACDJ,oBAAY,MAAA,MAAA,OAAA,iBAAA,qBAAqB,oBAAoB;AAAA,IACtD,SAAQ,OAAO;AACdA,0DAAc,0BAA0B,KAAK;AAAA,IAC9C;AAAA,EACF,GAAE,GAAI;AAEP,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}