{"version":3,"file":"orders.js","sources":["services/orders.js"],"sourcesContent":["/**\n * 订单管理服务\n * 处理积分商城奖品兑换记录相关的操作\n */\n\n// 获取用户的订单列表\nexport async function getUserOrders(refresh = false) {\n  try {\n    // 如果设置了刷新标志或本地没有缓存，则从云端获取数据\n    const cacheKey = 'user_orders_cache';\n    const cachedData = !refresh ? uni.getStorageSync(cacheKey) : null;\n    \n    if (cachedData) {\n      console.log('从缓存中获取订单数据');\n      return JSON.parse(cachedData);\n    }\n    \n    console.log('从云端获取订单数据');\n    const { result } = await uniCloud.callFunction({\n      name: 'getUserOrders'\n    });\n    \n    if (result && result.success) {\n      // 缓存订单数据\n      uni.setStorageSync(cacheKey, JSON.stringify(result));\n      return result;\n    } else {\n      console.error('获取订单数据失败:', result?.message || '未知错误');\n      return {\n        success: false,\n        message: result?.message || '获取订单数据失败',\n        data: []\n      };\n    }\n  } catch (error) {\n    console.error('获取订单数据出现异常:', error);\n    return {\n      success: false,\n      message: '获取订单数据出现异常: ' + error.message,\n      data: []\n    };\n  }\n}\n\n// 订单状态映射\nexport const OrderStatusMap = {\n  pending: { text: '待处理', color: '#f59e0b' },\n  processing: { text: '处理中', color: '#3b82f6' },\n  shipped: { text: '已发货', color: '#8b5cf6' },\n  delivered: { text: '已送达', color: '#4CAF50' },\n  cancelled: { text: '已取消', color: '#ef4444' }\n};\n\n// 获取订单状态显示文本\nexport function getOrderStatusText(status) {\n  return OrderStatusMap[status]?.text || '未知状态';\n}\n\n// 获取订单状态显示颜色\nexport function getOrderStatusColor(status) {\n  return OrderStatusMap[status]?.color || '#6b7280';\n}\n\n// 格式化订单时间\nexport function formatOrderTime(timestamp) {\n  if (!timestamp) return '';\n  \n  const date = new Date(timestamp);\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  const hour = String(date.getHours()).padStart(2, '0');\n  const minute = String(date.getMinutes()).padStart(2, '0');\n  \n  return `${year}-${month}-${day} ${hour}:${minute}`;\n} "],"names":["uni","uniCloud"],"mappings":";;AAMO,eAAe,cAAc,UAAU,OAAO;AACnD,MAAI;AAEF,UAAM,WAAW;AACjB,UAAM,aAAa,CAAC,UAAUA,cAAAA,MAAI,eAAe,QAAQ,IAAI;AAE7D,QAAI,YAAY;AACdA,oBAAAA,MAAA,MAAA,OAAA,4BAAY,YAAY;AACxB,aAAO,KAAK,MAAM,UAAU;AAAA,IAC7B;AAEDA,kBAAAA,MAAY,MAAA,OAAA,4BAAA,WAAW;AACvB,UAAM,EAAE,OAAM,IAAK,MAAMC,cAAAA,GAAS,aAAa;AAAA,MAC7C,MAAM;AAAA,IACZ,CAAK;AAED,QAAI,UAAU,OAAO,SAAS;AAE5BD,oBAAG,MAAC,eAAe,UAAU,KAAK,UAAU,MAAM,CAAC;AACnD,aAAO;AAAA,IACb,OAAW;AACLA,0BAAc,MAAA,SAAA,4BAAA,cAAa,iCAAQ,YAAW,MAAM;AACpD,aAAO;AAAA,QACL,SAAS;AAAA,QACT,UAAS,iCAAQ,YAAW;AAAA,QAC5B,MAAM,CAAE;AAAA,MAChB;AAAA,IACK;AAAA,EACF,SAAQ,OAAO;AACdA,kBAAc,MAAA,MAAA,SAAA,4BAAA,eAAe,KAAK;AAClC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS,iBAAiB,MAAM;AAAA,MAChC,MAAM,CAAE;AAAA,IACd;AAAA,EACG;AACH;AAGO,MAAM,iBAAiB;AAAA,EAC5B,SAAS,EAAE,MAAM,OAAO,OAAO,UAAW;AAAA,EAC1C,YAAY,EAAE,MAAM,OAAO,OAAO,UAAW;AAAA,EAC7C,SAAS,EAAE,MAAM,OAAO,OAAO,UAAW;AAAA,EAC1C,WAAW,EAAE,MAAM,OAAO,OAAO,UAAW;AAAA,EAC5C,WAAW,EAAE,MAAM,OAAO,OAAO,UAAW;AAC9C;AAGO,SAAS,mBAAmB,QAAQ;;AACzC,WAAO,oBAAe,MAAM,MAArB,mBAAwB,SAAQ;AACzC;AAGO,SAAS,oBAAoB,QAAQ;;AAC1C,WAAO,oBAAe,MAAM,MAArB,mBAAwB,UAAS;AAC1C;AAGO,SAAS,gBAAgB,WAAW;AACzC,MAAI,CAAC;AAAW,WAAO;AAEvB,QAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,QAAM,OAAO,KAAK;AAClB,QAAM,QAAQ,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AACzD,QAAM,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,QAAM,OAAO,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AACpD,QAAM,SAAS,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AAExD,SAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,IAAI,IAAI,MAAM;AAClD;;;;;"}