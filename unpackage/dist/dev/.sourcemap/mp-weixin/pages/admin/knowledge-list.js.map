{"version":3,"file":"knowledge-list.js","sources":["pages/admin/knowledge-list.vue","../../../Software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRtaW4va25vd2xlZGdlLWxpc3QudnVl"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 顶部导航栏 -->\n\t\t<view class=\"header bg-green px-4 py-3\">\n\t\t\t<view class=\"flex items-center\">\n\t\t\t\t<view @tap=\"goBack\" class=\"p-2\">\n\t\t\t\t\t<image src=\"/static/images/icons/icon-back.svg\" class=\"back-icon\"></image>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"flex-1 text-center\">\n\t\t\t\t\t<text class=\"text-white text-lg font-medium\">环保知识和小贴士</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"w-24px\"></view> <!-- 为了居中标题的占位 -->\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<view class=\"knowledge-list p-4\">\n\t\t\t<view class=\"empty-tip\" v-if=\"knowledgeList.length === 0\">\n\t\t\t\t<text>暂无环保知识，点击右下角按钮添加</text>\n\t\t\t</view>\n\t\t\t<view class=\"knowledge-item\" v-for=\"(item, index) in knowledgeList\" :key=\"item._id\">\n\t\t\t\t<view class=\"knowledge-content\" @click=\"goToEdit(item)\">\n\t\t\t\t\t<view class=\"knowledge-title\">{{item.title}}</view>\n\t\t\t\t\t<view class=\"knowledge-info\">\n\t\t\t\t\t\t<image v-if=\"item.image\" class=\"knowledge-image\" :src=\"item.image\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t<view class=\"knowledge-meta\">\n\t\t\t\t\t\t\t<view class=\"knowledge-tags\">\n\t\t\t\t\t\t\t\t<text class=\"tag\" v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\"># {{tag}}</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"knowledge-date\">{{formatDate(item.created_at)}}</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"knowledge-actions\">\n\t\t\t\t\t<image src=\"/static/images/icons/icon-more.svg\" class=\"icon-more\" @click=\"showActionSheet(item)\"></image>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 添加按钮 -->\n\t\t<view class=\"float-btn\" @click=\"goToAdd\">\n\t\t\t<view class=\"float-btn-inner\">\n\t\t\t\t<text class=\"plus-text\">+</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tknowledgeList: []\n\t\t\t}\n\t\t},\n\t\tonShow() {\n\t\t\tthis.getKnowledgeList();\n\t\t},\n\t\tmethods: {\n\t\t\t// 返回上一页\n\t\t\tgoBack() {\n\t\t\t\tuni.navigateBack();\n\t\t\t},\n\t\t\tasync getKnowledgeList() {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'getKnowledge'\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.knowledgeList = res.result.data;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '获取知识列表失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '获取知识列表失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tformatDate(timestamp) {\n\t\t\t\tif (!timestamp) return '';\n\t\t\t\tconst date = new Date(timestamp);\n\t\t\t\treturn `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;\n\t\t\t},\n\t\t\tgoToAdd() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/admin/knowledge-add'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoToEdit(item) {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: `/pages/admin/knowledge-edit?id=${item._id}`\n\t\t\t\t});\n\t\t\t},\n\t\t\tshowActionSheet(item) {\n\t\t\t\tuni.showActionSheet({\n\t\t\t\t\titemList: ['删除'],\n\t\t\t\t\titemColor: '#FF0000',\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif (res.tapIndex === 0) {\n\t\t\t\t\t\t\tthis.deleteKnowledge(item._id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tasync deleteKnowledge(id) {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'deleteKnowledge',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t_id: id\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '删除成功',\n\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.getKnowledgeList();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.result.message || '删除失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '删除失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.container {\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f8f9fa;\n\t}\n\t\n\t.header {\n\t\tpadding-top: 44px;\n\t\tpadding-bottom: 12px;\n\t\tbox-sizing: content-box;\n\t}\n\t\n\t.bg-green {\n\t\tbackground-color: #4CAF50;\n\t}\n\t\n\t.w-24px {\n\t\twidth: 24px;\n\t}\n\t\n\t.knowledge-list {\n\t\t.empty-tip {\n\t\t\ttext-align: center;\n\t\t\tpadding: 50rpx 0;\n\t\t\tcolor: #999;\n\t\t}\n\t\t\n\t\t.knowledge-item {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: flex-start;\n\t\t\tpadding: 20rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tbackground-color: #FFFFFF;\n\t\t\tborder-radius: 10rpx;\n\t\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n\t\t\t\n\t\t\t.knowledge-content {\n\t\t\t\tflex: 1;\n\t\t\t\t\n\t\t\t\t.knowledge-title {\n\t\t\t\t\tfont-size: 32rpx;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tmargin-bottom: 10rpx;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.knowledge-info {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\n\t\t\t\t\t.knowledge-image {\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\theight: 300rpx;\n\t\t\t\t\t\tborder-radius: 8rpx;\n\t\t\t\t\t\tmargin-bottom: 10rpx;\n\t\t\t\t\t\tobject-fit: cover;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t.knowledge-meta {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\t\n\t\t\t\t\t\t.knowledge-tags {\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\tflex-wrap: wrap;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t.tag {\n\t\t\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\t\t\tcolor: #4CAF50;\n\t\t\t\t\t\t\t\tmargin-right: 10rpx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t.knowledge-date {\n\t\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\t\tcolor: #999;\n\t\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t.knowledge-actions {\n\t\t\t\tpadding: 0 10rpx;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t.back-icon {\n\t\twidth: 18px;\n\t\theight: 18px;\n\t}\n\t\n\t.float-btn {\n\t\tposition: fixed;\n\t\tbottom: 80px;\n\t\tright: 20px;\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tz-index: 100;\n\t}\n\t\n\t.float-btn-inner {\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tborder-radius: 25px;\n\t\tbackground-color: #4CAF50;\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcolor: white;\n\t\tfont-size: 24px;\n\t}\n\t\n\t.plus-text {\n\t\tcolor: white;\n\t\tfont-size: 30px;\n\t\tfont-weight: bold;\n\t\tline-height: 30px;\n\t\ttext-align: center;\n\t\tmargin-top: -2px; /* 轻微上移调整垂直位置 */\n\t}\n\t\n\t/* 工具类 */\n\t.flex { display: flex; }\n\t.flex-1 { flex: 1; }\n\t.items-center { align-items: center; }\n\t.justify-center { justify-content: center; }\n\t.text-center { text-align: center; }\n\t.text-white { color: #ffffff; }\n\t.text-lg { font-size: 18px; }\n\t.font-medium { font-weight: 500; }\n\t.px-4 { padding-left: 16px; padding-right: 16px; }\n\t.py-3 { padding-top: 12px; padding-bottom: 12px; }\n\t.p-4 { padding: 16px; }\n\t\n\t.icon-more {\n\t\twidth: 20px;\n\t\theight: 20px;\n\t\tpadding: 4px;\n\t}\n</style> ","import MiniProgramPage from 'D:/Documents/HBuilderProjects/CarbonFootprint/pages/admin/knowledge-list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;;AAgDC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,eAAe,CAAC;AAAA,IACjB;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,iBAAgB;AAAA,EACrB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IAChB;AAAA,IACD,MAAM,mBAAmB;AACxB,UAAI;AACH,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,QACP,CAAC;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAC1B,eAAK,gBAAgB,IAAI,OAAO;AAAA,eAC1B;AACND,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAC;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAc,MAAA,SAAA,wCAAA,CAAC;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA,IACA;AAAA,IACD,WAAW,WAAW;AACrB,UAAI,CAAC;AAAW,eAAO;AACvB,YAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,aAAO,GAAG,KAAK,YAAW,CAAE,IAAI,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG,CAAC,IAAI,OAAO,KAAK,SAAS,EAAE,SAAS,GAAG,GAAG,CAAC;AAAA,IACvH;AAAA,IACD,UAAU;AACTA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,IACD,SAAS,MAAM;AACdA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,kCAAkC,KAAK,GAAG;AAAA,MAChD,CAAC;AAAA,IACD;AAAA,IACD,gBAAgB,MAAM;AACrBA,oBAAAA,MAAI,gBAAgB;AAAA,QACnB,UAAU,CAAC,IAAI;AAAA,QACf,WAAW;AAAA,QACX,SAAS,SAAO;AACf,cAAI,IAAI,aAAa,GAAG;AACvB,iBAAK,gBAAgB,KAAK,GAAG;AAAA,UAC9B;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IACD,MAAM,gBAAgB,IAAI;AACzB,UAAI;AACH,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,KAAK;AAAA,UACN;AAAA,QACD,CAAC;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAC1BD,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAC;AACD,eAAK,iBAAgB;AAAA,eACf;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,OAAO,WAAW;AAAA,YAC7B,MAAM;AAAA,UACP,CAAC;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAc,MAAA,SAAA,yCAAA,CAAC;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA,IACD;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3ID,GAAG,WAAW,eAAe;"}